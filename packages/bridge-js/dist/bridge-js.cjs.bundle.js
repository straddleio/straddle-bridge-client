var StraddleBridge=function(e){"use strict";function t(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var o=function e(){if(this instanceof e){var o=[null];return o.push.apply(o,arguments),new(Function.bind.apply(t,o))}return t.apply(this,arguments)};o.prototype=t.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var d=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(o,t,d.get?d:{enumerable:!0,get:function(){return e[t]}})})),o}var o,d={};!function(e){e.PING="@straddleio/js-bridge/ping",e.ERROR="@straddleio/js-bridge/error",e.INITIALIZE="@straddleio/js-bridge/initialize",e.INITIALIZING="@straddleio/js-bridge/initializing",e.INITIALIZED="@straddleio/js-bridge/initialized",e.MOUNTED="@straddleio/js-bridge/mounted",e.ON_PAYKEY="@straddleio/js-bridge/on-paykey",e.ON_SUCCESS="@straddleio/js-bridge/on-success",e.ON_SUCCESS_CTA_CLICKED="@straddleio/js-bridge/on-success-cta-clicked",e.ON_CLOSE="@straddleio/js-bridge/on-close",e.ON_MANUAL_ENTRY="@straddleio/js-bridge/on-manual-entry",e.ON_RETRY="@straddleio/js-bridge/on-retry",e.TOKEN="@straddleio/js-bridge/token",e.DEBUG="@straddleio/js-bridge/debug",e.CONSOLE="@straddleio/js-bridge/console"}(o||(o={}));var r=t(Object.freeze({__proto__:null,get EBridgeMessageType(){return o}}));e.straddleBridge=void 0;var n=r;const i="Straddle-widget-iframe",s={production:"https://bridge.straddle.io",sandbox:"https://bridge-sandbox.straddle.io"},l={getUrl:()=>`${l.origin}/${"undefined"!=typeof window&&encodeURIComponent(window.location.origin.replace("https://","").replace("http://",""))}`,origin:"",mounted:!1,verbose:!1,init:function(e){let{mode:t,appUrl:o,token:d,onSuccess:r,onSuccessCTAClicked:a,onClose:g,onLoadError:c,allowManualEntry:u=!0,onManualEntry:p,onRetry:y,targetRef:b,style:E,className:f,verbose:m=!1}=e;o=null!=o?o:(e=>s[null!=e?e:"production"])(t),o=o.endsWith("/")?o.slice(0,-1):o,l.origin=null!=o?o:"https://production.straddle.io",m&&console.log("init called");const v=document.createElement("iframe");v.setAttribute("src",l.getUrl()+"?allowManualEntry="+u),v.addEventListener("error",(e=>{console.error("Error loading Straddle Widget"),null==c||c(e)})),v.id=i;let w=E;E||(w={position:"fixed",width:"100%",height:"100%",top:"0%",left:"0",zIndex:"2147483647"}),Object.assign(v.style,w),f&&f.split(" ").forEach((e=>{v.classList.add(e)})),(b||document.getElementsByTagName("body")[0]).appendChild(v),"undefined"!=typeof window&&window.addEventListener("message",(function(e){var t,o,s;if(e.origin===l.origin){m&&console.log("Message received from widget:",e.data.type,e),m&&(()=>{try{return window.self!==window.top}catch(e){return!0}})()&&(null===(o=null===(t=window.parent)||void 0===t?void 0:t.postMessage)||void 0===o||o.call(t,e.data,"*"));const c=e.data;switch(null==c?void 0:c.type){case n.EBridgeMessageType.MOUNTED:l.mounted=!0,l.send({type:n.EBridgeMessageType.INITIALIZE,token:d});break;case n.EBridgeMessageType.ON_CLOSE:null==g||g(),l.mounted=!1,null===(s=document.querySelector(`#${i}`))||void 0===s||s.remove();break;case n.EBridgeMessageType.ON_SUCCESS_CTA_CLICKED:document.getElementsByTagName("body")[0].removeChild(v),null==a||a();break;case n.EBridgeMessageType.ON_MANUAL_ENTRY:null==p||p();break;case n.EBridgeMessageType.ON_RETRY:null==y||y();break;case n.EBridgeMessageType.ON_PAYKEY:null==r||r(c.paykeyResponse);break;case n.EBridgeMessageType.CONSOLE:{const e=c.payload.map((e=>{try{return JSON.parse(e)}catch(t){return e}}));"method"in c&&console[c.method].apply(console,e)}}}}))},getIframe:()=>document.getElementById("Straddle-widget-iframe"),show:()=>{l.verbose&&console.log("straddleBridge.show method called.");const e=l.getIframe();l.verbose&&e&&console.log("iframe found, setting display to block."),e.style.display="block"},hide:()=>{l.verbose&&console.log("straddleBridge.hide method called.");const e=l.getIframe();l.verbose&&e&&console.log("iframe found, setting display to none."),e.style.display="none"},remove:()=>{l.verbose&&console.log("straddleBridge.remove method called.");const e=l.getIframe();null==e||e.remove(),l.mounted=!1},send:function(e){var t;const o=document.getElementById("Straddle-widget-iframe");console.log("sending message:",e,"to",l.origin),null===(t=null==o?void 0:o.contentWindow)||void 0===t||t.postMessage(e,l.origin)}};return"undefined"!=typeof window&&(window.straddleBridge=l),Object.defineProperty(l,"debug",{value:{enable:()=>l.send({type:n.EBridgeMessageType.DEBUG,enable:!0}),disable:()=>l.send({type:n.EBridgeMessageType.DEBUG,enable:!1})},enumerable:!1,writable:!1,configurable:!1}),e.straddleBridge=d.straddleBridge=l,e.default=d,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
